# 이 파일은 개발용으로 'frontend' 서비스만 덮어씁니다.
services:
  frontend:
    # 1. Dockerfile로 빌드하는 대신, node 이미지를 바로 사용합니다.
    image: node:20-alpine
    container_name: gopra_frontend_dev
    working_dir: /app/frontend
    
    # 2. 로컬의 frontend 코드를 컨테이너의 /app/frontend로 "연결" (마운트)
    volumes:
      - ./frontend:/app/frontend
      # node_modules는 컨테이너의 것을 사용하도록 분리
      - /app/frontend/node_modules 
    
    # 3. Vite 개발 서버 포트(5173)를 엽니다. (80포트가 아님)
    ports:
      - "5173:5173"
      
    # 4. 'npm run build' 대신 'npm run dev'를 실행
    command: sh -c "npm install && npm run dev"
    
    depends_on:
      - backend
      
    environment:
      # 5. Vite가 API 서버(backend)를 찾을 수 있게 주소 설정
      - VITE_API_URL=http://backend:8080
      # 6. Docker 볼륨 마운트 환경에서 파일 변경 감지를 위한 설정
      - CHOKIDAR_USEPOLLING=true
