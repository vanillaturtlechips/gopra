웹개발에 종사하는 많은 사람이 RESTful API에 익숙하고, 나도 실제로 GO를 통해 해당 API를 구현해보면서 HTTP 메서드를 사용하는 REST 아키텍처를 준수하는 놈이라고 이해했다. 적어도 이름만 봐도 의미를 알 수 있었다.

전통적인 인터페이스는 동사 + 인터페이스 이름을 사용하여 의미를 전달하는 반면에, RESTful은 GET(데이터 가져오기), POST(생성), PUT(수정), DELETE(삭제)와 같은 HTTP 요청 메서드를 사용하여 작업을 정의할 것을
권장한다.

##
```
/students GET 모든 학생 목록 조회 GetAllStudents
/students POST 새 학생 정보 등록 CreateStudent
/students/{id} GET 특정 학생 정보 조회 GetStudentByID
/students/{id} PUT 특정 학생 정보 수정 UpdateStudent
/students/{id} DELETE 특정 학생 정보 삭제 DeleteStudent
```
##

여기에 /student를 사용할지 /students를 사용할지에 대한 논쟁이 있다. 일부 사람들은 여러 사용자가 있으므로 복수형을 사용해야 하며, 사용자를 가져올 때는 getstudnets를 사용해야 한다고 생각할 수도 있다. 
이는 데이터베이스 테이블 이름에서도 동일하게 존재하는 문제

물론 내 생각은 데이터베이스 모델링에 명시된 규칙에 따르는게 best practice라는 생각이 든다. 테이블 이름과 인터페이스에도 동일하게 사용하는게 팀원들도 헷갈리지 않아서 좋지 않을까

또한, RESTful은 HTTP 상태 코드를 사용하여 결과를 구분할 것을 권장한다. 200은 정상 400은 클라이언트 에러 500은 서버 에러 등등... 

##
```
w.WriteHeader(http.StatusOK)
http.Error(w, "잘못된 요청입니다.", http.StatusBadRequest)
http.Error(w, "JSON 변환 실패", http.StatusInternalServerError)
```
##

요컨대, RESTful은 원래 이러한 데이터 엔티티들을 자원(Resource)으로 취급하고, URL로 자원의 위치를 파악하며, HTTP 메서드를 사용하여 작업을 정의함으로써 다음 몇 가지 목표를 달성하도록 설계된다.
내 경우는 리소스를 students, 즉 학생으로 지정해서 설계를 하였다.

- URL을 보면 무엇을 가져오는지 알 수 있다.
- HTTP 메서드를 보면 무엇을 할 것인지 알 수 있다.
- HTTP 상태 코드를 보면 결과가 무엇인지 알 수 있다.

그러므로 매우 직관적이고 깔끔한 코드가 완성된다.

RESTful 설계 사양은 이상적이지만, 모든 프로젝트에 적합한 것은 아니다. 많은 인터페이스가 순수한 CRUD 작업이 아니며, 단순히 테이블에 삽입, 삭제, 업데이트, 쿼리하는 것만이 아니기 때문에 URL을 통해 의미를 전달하기 어려울 수 있다.

RESTful은 단순히 데이터를 가져오고 수정하는 인터페이스에 더 적합하다. 하지만 인터페이스에 매우 복잡한 비즈니스 로직이 포함되어 있다면, RESTful은 문제가 되며 어디서부터 시작해야 할지 난감해진다.

예를 들어서 어떤 정신나간 학생이 매장에서 1500원 정도의 크림빵을 슈킹한다고 가정했을때, 해당 피드백을 받아 학생(학번)-매점이 조인된 새 인터페이스를 짜한다면...

전통적인 방식으로 해야 하나, 사용자 중심으로 인터페이스를 지정해야하나, 마켓 중심으로 인터페이스를 지정해야 하는건지 고민이 들 수 밖에 없다.

세 가지 예시 중 어느 것이 더 나은걸까? 제일 적합한 방식은 2번이라고 생각이 든다. 추적하기 쉬우니까.

##
```
/getStudentsNearbyMarket?Students_id=1 (RPC 방식)
/students/{id}/order_number~ (RESTful 사용자)
/market/{food_id}/students/~ (RESTful 마켓)
```
##


때로는 RESTful API가 정의하는 GET, POST, PUT, DELETE의 네 가지 일반적인 메서드가 모든 애플리케이션 시나리오를 충족하지 못하거나 충분히 명확하지 않을 수 있다. 예를 들어, 슈킹한 학생의 마켓 블랙리스트를 지우는 비즈니스 시나리오가 있다면, 이것은 PUT일까 아니면 DELETE일까?

학생의 관점에서 보면 PUT이라고 할 수 있다. 학생에 부착된 속성을 수정하는 것이기 때문이다. 하지만 블랙리스트의 관점에서 보면 데이터를 삭제하는 것이므로, 둘 다 어느 정도 타당성이 있다.

이러한 모호성은 RESTful API 설계에서 '자원의 명확한 정의'를 통해 해결하라고 한다.

그럼 블랙 리스트를 새 독립적인 리소스로 가정하고 로직을 세워야 한다.

근데 블랙 리스트 삭제라는 인터페이스에 자체에 여러 자원의 상태(훔쳐간 물건의 재고 관리(-1에서 아마 0으로), 징계 기간, 갚아야 하는 금액, 담탱이와의 면담 등등)가 바뀔 수 있고, 이 작업을 단순하게 http 메서드로 표현하기 어렵다고 생각이 들기도 한다. 그걸 위해 커스텀 동사 (Action) 엔드포인트라는 행위 중심 방식이 있는데..

우리는 students를 사용자의 속성으로, unban를 행동(action)으로 생각할 수 있다. 이는 조금 더 명확하며, 메서드가 POST든 PUT이든 큰 차이는 없다.

##
```
RESTful DELETE /students/{studentId}/blacklist_entrie
Action EndPoint POST /students/{studentId}/unban, POST /students/{studentId}/remove_from_blacklist
```
##

AWS에서 REST API는 주로 Amazon API Gateway라는 서비스를 중심으로 작동하며, 클라이언트의 요청을 받아 백엔드 서비스(예: AWS Lambda, EC2 인스턴스, 또는 다른 HTTP 엔드포인트)로 연결하는 단일 진입점(Single Entry Point) 역할을 수행한다.

클라우드 서비스 자체는 서버, IP, 도메인 이름과 같은 자원(Resource)을 제공하는 것이며, RESTful은 자원을 설명하기 위해 탄생됐다. 또한, 클라우드 서비스의 운영 로직은 단순하여 복잡한 비즈니스 로직이 없다. 서버의 경우 생성, 보기, 수정, 삭제, 재시작 등일 뿐이다.

<img width="832" height="231" alt="image" src="https://github.com/user-attachments/assets/2c9c03ce-cccc-42eb-ae48-1e9b4d7d7bb8" />

그러나 많은 인터페이스의 경우, RESTful이 최선의 선택이 아닐 때가 많다. 단순성과 편리성을 위해 이러한 복잡한 사양에 얽매이지 않으려면, 데이터를 가져오는 GET을 제외하고는 모든 것에 POST를 사용하는 방식인 동사 기반 엔드포인트 방식을 사용한다.

어떤 미들웨어가 어떻게 어떤 방식으로 처리할지 알 수 없기 때문에(비즈니스 로직이 복잡해도 너무 복잡해져서) POST로 때려박는게 아닐까..

결론적으로

RESTful 스타일 API를 사용해야 하는지에 대한 질문에는 명확한 답이 없다고 생각한다.

애플리케이션 로직이 단순하고 대부분 데이터 테이블의 추가, 삭제, 업데이트, 조회와 관련된 경우, RESTful 스타일 인터페이스를 사용하는 것을 고려할 수 있다.

반대로 애플리케이션 비즈니스 로직이 복잡하다면, RESTful을 사용하지 않아도 된다.(ex. GRPC, RPC)

실제로는 두 가지를 혼합하여 사용할 수도 있다. 실제 상황에 따라 결정하는 것이니까. 결국 이것은 단지 인터페이스 라우팅일 뿐이며, 너무 많은 고민을 할 필요는 없다. 대부분의 웹 프레임워크는 다양한 형태의 라우팅 매개변수를 지원하므로, 단순한 CRUD에는 RESTful을 사용하고, 복잡한 비즈니스 로직에는 특별한 처리를 할 수 있을 것이다.

나도 다음 프로젝트 설계땐 이러한 원칙을 잘 생각해보면서 어떻게 api를 설계할지 고민해보는 시간을 가져야겠다.
